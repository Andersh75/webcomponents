<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Tue Jan 09 2018 15:12:51 GMT+0000 (UTC)  -->
<html data-wf-page="5a53e8f702eb7600018da9b7" data-wf-site="5a53e8f702eb7600018da9b6">
<head>
  <meta charset="utf-8">
  <title>Parmaco</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">

  <!--<link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/parmaco-5cd88a.webflow.css" rel="stylesheet" type="text/css"> 
  <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">-->
  <!-- <script src="ce/infosection.js"></script> -->
  <!-- <script src="ce/sectioncontainer.js"></script>--><!--
  <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>-->
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="https://daks2k3a4ib2z.cloudfront.net/img/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="https://daks2k3a4ib2z.cloudfront.net/img/webclip.png" rel="apple-touch-icon">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script>
    var events = (function () {
        var topics = {};
        var hOP = topics.hasOwnProperty;

        return {
            subscribe: function (topic, listener) {
                // Create the topic's object if not yet created
                if (!hOP.call(topics, topic)) 
                    topics[topic] = [];
                
                // Add the listener to queue
                var index = topics[topic].push(listener) - 1;

                // Provide handle back for removal of topic
                return {
                    remove: function () {
                        delete topics[topic][index];
                    }
                };
            },
            publish: function (topic, info) {
                // If the topic doesn't exist, or there's no listeners in queue, just leave
                if (!hOP.call(topics, topic)) 
                    return;
                
                // Cycle through topics queue, fire!
                topics[topic].forEach(function (item) {
                    item(
                        info != undefined
                            ? info
                            : {}
                    );
                });
            }
        };
    })();


    function eventPublisherMaker() {
        let eventNames = [];

        return function eventPublisher(eventName) {

            if (eventNames.indexOf(eventName) == -1) {
                eventNames.push(eventName);

                function publishEvent(e) {
                    return events.publish(eventName, e);
                }

                document.addEventListener(eventName, publishEvent);
            }
        };
    }

    let eventPublisher = eventPublisherMaker();

    function eventDispatcher(element, eventName, details) {
        element.dispatchEvent(new CustomEvent(eventName, {
            bubbles: true,
            cancelable: true,
            composed: true,
            detail: details
        }));

    }

    function setComponentListener(model) {
        let listener = this.listener;
        //alert(listener);
        if (h.boolean.isString(listener)) {
            let listeners = h.str.stringToArrayUsingSplitter(' ', listener);
            console.log(listeners);
            listeners.forEach(listener => {
                let listeners = h.str.stringToArrayUsingSplitter('@', listener);
                let remoteEvent = listeners[0];
                let localEvents = listeners.slice(1);

                localEvents.forEach(localEvent => {
                    events.subscribe(remoteEvent, function(e) {
                    console.log('catched event');
                    console.log(model);
                    model.dispatch(localEvent, e);	
                });
                })
            });
        }
        
    }

    function setComponentDispatcher() {
        eventPublisher(this.dispatch);
    }

    function setConnectedCallback() {
        setComponentListener.call(this, this.model);
        setComponentDispatcher.call(this);
    }

    function Ctrl(model, view) {
			let that = this;

			return {
				// register: function() {
				// 	return model.register(this);
				// },
                eval: function(name) {
                    return eval(name) 
                }
			};
		}

	function View(model) {
			let that = this;

			return {
                eval: function(name) {
                    return eval(name) 
                }
			}; 
		}

	function Model() {
            let that = this;
            
            const eventTarget = document.createElement('event-target');

			return {
				dispatch: function(eventName, e) {
                    console.log(eventName);
					return eventTarget.dispatchEvent(new CustomEvent(eventName, {detail: e}));
                },
                // register: function() {
                // },
                eval: function(name) {
                    return eval(name) 
                }
			};
		}

    class customElement extends HTMLElement {

        constructor() {
        super();
        this.thatDoc = document;
    	this.thisDoc = (this.thatDoc._currentScript || this.thatDoc.currentScript).ownerDocument;
		this.template = this.thisDoc.querySelector( 'template' ).content;

        this.attachShadow({ mode: 'open' });
        
        this.model = Model();
        this.view = View(this.model);
        this.ctrl = Ctrl(this.model, this.view);
        }

        get dispatch() {
            return this.getAttribute('dispatch');
        }

        set dispatch(newDispatch) {
            return this.setAttribute('dispatch', newDispatch);
        }

        get listener() {
			return this.getAttribute('listener');
		}

		set listener(newListener) {
			return this.setAttribute('listener', newListener);
        }

        connectedCallback() {
            setConnectedCallback.call(this);
            //this.extendModel();
            
        }
        
        extend() {
            this.eventTarget = this.model.eval("eventTarget");
            this.shadowRoot.appendChild(this.template.cloneNode(true));
            this.extendModel(this);
            this.extendCtrl(this);
            this.extendView(this);
            Object.keys(this.ctrl).slice(1).map(key => {
                this.eventTarget.addEventListener(h.str.toLowerCase(key), this.ctrl[key]);
            });
            this.addEventListener('keydown', e => {
				let el = e.composedPath()[0];
				
				if (e.keyCode === 32 || e.keyCode === 13) {
					el.dispatchEvent(
						new MouseEvent('click', {bubbles: true, cancelable: true, composed: true}));
				}
			});

			this.addEventListener('click', e => {
				e.stopPropagation;
				eventDispatcher(this.eventTarget, 'useraction', e);
				
            });

            if (this.shadowRoot.querySelector('select') !== null) {
                this.shadowRoot.querySelector('select').addEventListener('change', e => {
				e.stopPropagation;
                eventDispatcher(this.eventTarget, 'useraction', e);
			    });
            };
            
 
            this.connectedCallback()
            
        }


        
        attributeChangedCallback(name, oldVal, newVal) {
			let details = {};
			details.changedAttribute = {}
			details.changedAttribute.name = name;
			details.changedAttribute.oldVal = oldVal;
            details.changedAttribute.newVal = newVal;
            console.log(this);
            eventDispatcher(this, this.dispatch, details);
		}   
    }

    function getSlot(name, that) {
		return that.shadowRoot.querySelector("slot[name=" + name + "]");
    }



    //NOT DONE
    function defineElement(theClass, className) {
		console.log('hej');
		console.log(theClass.name);
		window.customElements.define(className, theClass);
    }




</script>
  
  <link rel="import" href="ce/infoinput.html">
  <link rel="import" href="ce/infoinput2.html">
  <link rel="import" href="ce/infoheadline2.html">
  <link rel="import" href="ce/infoselect.html">
  <link rel="import" href="ce/infoselect2.html">
  <link rel="import" href="ce/infoheadline.html">
  <link rel="import" href="ce/infosection.html">
  <link rel="import" href="ce/fancysection.html">
  <link rel="import" href="ce/sectioncontainer.html">
  <link rel="import" href="ce/togglebutton.html">


</head>
<body>


<info-headline2 listener="newinput@changeheadline">
    <span slot="text">Default</span>
</info-headline2>
<info-container>


    <toggle-button slot="b1" toggle="on" effect="display" section="heat" dispatch="newtoggle">TOGGLE HEAT SECTION VISIBILITY</toggle-button>
    <toggle-button slot="b1" toggle="on" effect="display" section="heat" dispatch="heat-section-toggle">TOGGLE HEAT SECTION VISIBILITY</toggle-button>

    <info-input2 dispatch="newinput-heatsection" slot="i1" value="testvalue"></info-input2>
    

    <fancy-section slot="s1" listener="heat-section-toggle@toggleupdated@changecolor"> 
        <info-headline2 listener="newinput-heatsection@changeheadline newselect@changeselect" slot="headline" year="1">
            <span slot="text">Default</span>
        </info-headline2>   

        <info-headline2 listener="newinput@changeheadline" slot="headline" year="1">
            <span slot="text">Default</span>
        </info-headline2>
        

    </fancy-section>

    <info-select2 dispatch="newselect" slot="select1" selectedindex="1"></info-select2>
</info-container>



<script type="text/javascript" src="/js/test.js"></script>


<!-- <script type="text/javascript" src="/ifServiceWorker.js"></script> -->
<!-- <script src="js/chartist.js" type="text/javascript"></script> -->

<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/ramda/0.25.0/ramda.min.js"></script>
<script type="text/javascript" src="/js/pouchdb-6.4.1.js"></script>
<script type="text/javascript" src="/js/pouchdb.find.js"></script> 
<script type="text/javascript" src="/js/curry.js"></script>
<script type="text/javascript" src="/js/helper.js"></script>
<script type="text/javascript" src="/js/unittests.js"></script>
<script type="text/javascript" src="/js/views.js"></script>
 

<script src="js/webflow.js" type="text/javascript"></script> -->
<!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->

</body>
</html>
